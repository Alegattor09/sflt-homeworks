# Домашнее задание к занятию 2 «Кластеризация и балансировка нагрузки» - Вязников Павел

### Цель задания
В результате выполнения этого задания вы научитесь:
1. Настраивать балансировку с помощью HAProxy
2. Настраивать связку HAProxy + Nginx

------

### Чеклист готовности к домашнему заданию

1. Установлена операционная система Ubuntu на виртуальную машину и имеется доступ к терминалу
2. Просмотрены конфигурационные файлы, рассматриваемые на лекции, которые находятся по [ссылке](2/)


------

### Задание 1
- Запустите два simple python сервера на своей виртуальной машине на разных портах
- Установите и настройте HAProxy, воспользуйтесь материалами к лекции по [ссылке](2/)
- Настройте балансировку Round-robin на 4 уровне.
- На проверку направьте конфигурационный файл haproxy, скриншоты, где видно перенаправление запросов на разные серверы при обращении к HAProxy.

### Решение 1

1. Cкриншот перенаправления запросов на разные серверы
![Cкриншот раздела Configuration > Hosts](https://github.com/Alegattor09/sflt-homeworks/blob/main/img/2-1.png)

2. Cсылка на конфигурацию haproxy - 
![l4haproxy config file](https://github.com/Alegattor09/sflt-homeworks/blob/main/haproxyconf/l4haproxy.cfg)


--- 

### Задание 2
- Запустите три simple python сервера на своей виртуальной машине на разных портах
- Настройте балансировку Weighted Round Robin на 7 уровне, чтобы первый сервер имел вес 2, второй - 3, а третий - 4
- HAproxy должен балансировать только тот http-трафик, который адресован домену example.local
- На проверку направьте конфигурационный файл haproxy, скриншоты, где видно перенаправление запросов на разные серверы при обращении к HAProxy c использованием домена example.local и без него.

### Решение 2

1. Cсылка на конфигурацию haproxy - 
![l7haproxy config file](https://github.com/Alegattor09/sflt-homeworks/blob/main/haproxyconf/l7haproxy.cfg)

2. Скриншоты перенаправления запросов согласно установленым весам в файле конфигурации haproxy с использованием домена example.local

![Страница статистики](https://github.com/Alegattor09/sflt-homeworks/blob/main/img/2-2.jpg)


Отработка балансировки при запросе по домену example.local

![Наблюдение за логом-1](https://github.com/Alegattor09/sflt-homeworks/blob/main/img/2-3.jpg)

Отработка балансировки при запросе на порт хоста с ошибкой, в данном случае запросы не регистрируются на странице статистика т.к. балансировку haproxy не выполнил.

![Наблюдение за логом-2](https://github.com/Alegattor09/sflt-homeworks/blob/main/img/2-4.jpg)